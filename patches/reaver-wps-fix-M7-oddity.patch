*** exchange.c~	2014-09-11 23:05:45.173398690 -0400
--- exchange.c	2014-09-11 23:05:45.229399608 -0400
*************** enum wps_result do_wps_exchange()
*** 132,137 ****
--- 132,142 ----
                  break;
              case M7:
                  cprintf(VERBOSE, "[+] Received M7 message\n");
+ 		if(!m6_sent)
+ 		{
+ 			tx_type = SEND_WSC_NACK;
+ 			terminated = 1;
+ 		}
                  /* Fall through */
              case DONE:
                  if(get_key_status() == KEY2_WIP) 
